--- # node weight tracker app definition
- hosts: webservers
  become: yes
  tasks:
    - name: get nodejs installation
      ansible.builtin.shell: curl -sL https://deb.nodesource.com/setup_14.x -o nodesource_setup.sh | sudo -E bash -

    - name: install nodejs
      apt:
        name: nodejs
        state: present

    - name: project initialization
      ansible.builtin.shell: sudo npm init -y
      args:
        chdir: "node-weight-tracker/"

    - name: app dependencies installation
      shell:
         cmd: |
           sudo npm install @hapi/hapi@19 @hapi/bell@12 @hapi/boom@9 @hapi/cookie@11 @hapi/inert@6 @hapi/joi@17 @hapi/vision@6 dotenv@8 ejs@3 postgres@1 -y
           sudo npm install --save-dev nodemon@2 -y

    - name: create env file
      copy:
        dest: "node-weight-tracker/testenv"
        content: |
          test
